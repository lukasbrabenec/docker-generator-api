FROM {{ imageCode }}:{{ version }}

RUN apt-get update

{% if extensions is defined and extensions is not empty %}
{% if extensions.system.main is defined and extensions.system.main is not empty %}
RUN apt-get install -y {% for systemMainExtension in extensions.system.main %}{{ systemMainExtension.name }} {% endfor %}
{% endif %}
{% if extensions.system.custom is defined and extensions.system.custom is not empty %}
RUN {% for systemCustomExtension in extensions.system.custom %}{{ systemCustomExtension.customCommand }} {% endfor %}
{% endif %}
{% if extensions.special is defined and extensions.special is not empty %}
COPY --from=mlocati/php-extension-installer:latest /usr/bin/install-php-extensions /usr/local/bin/

RUN install-php-extensions {% for specialExtension in extensions.special %}{{ specialExtension.name }} {% endfor %}
{% endif %}
{% endif %}
