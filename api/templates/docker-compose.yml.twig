version: {{ dockerVersion }}

services:
{% for imageVersion in imageVersions %}
    {{ imageVersion.imageName }}:
        build:
            context: {{ imageVersion.dockerfileLocation }}
{% if imageVersion.environments is defined and imageVersion.environments is not empty %}
        enviornment:
{% for environment in imageVersion.environments %}
            - {{ environment.name }}={{ environment.value }}
{% endfor %}
{% endif %}
{% if imageVersion.ports is defined and imageVersion.ports is not empty %}
        ports:
{% for port in imageVersion.ports %}
            - {{ port.inward }}:{{ port.outward }}
{% endfor %}
{% endif %}
{% if imageVersion.volumes is defined and imageVersion.volumes is not empty %}
        volumes:
{% for volume in imageVersion.volumes %}
            - {{ volume.hostPath }}:{{ volume.containerPath }}
{% endfor %}
{% endif %}
{% endfor %}